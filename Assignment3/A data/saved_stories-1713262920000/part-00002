{"aid": "40047406", "title": "PCAP Did What \u2013 A Mini Project to Visualise Zeek Logs in Grafana", "url": "https://github.com/hackertarget/pcap-did-what", "domain": "github.com/hackertarget", "votes": 2, "user": "the_wanderer", "posted_at": "2024-04-16 01:10:38", "comments": 0, "source_title": "GitHub - hackertarget/pcap-did-what: Analyze pcaps with Zeek and a Grafana Dashboard", "source_text": "GitHub - hackertarget/pcap-did-what: Analyze pcaps with Zeek and a Grafana\nDashboard\n\nSkip to content\n\nSign in\n\n# Search code, repositories, users, issues, pull requests...\n\nSearch syntax tips\n\nSign in\n\nSign up\n\nYou signed in with another tab or window. Reload to refresh your session. You\nsigned out in another tab or window. Reload to refresh your session. You\nswitched accounts on another tab or window. Reload to refresh your session.\nDismiss alert\n\nhackertarget / pcap-did-what Public\n\n  * Notifications\n  * Fork 0\n  * Star 1\n\nAnalyze pcaps with Zeek and a Grafana Dashboard\n\n### License\n\nMIT license\n\n1 star 0 forks Branches Tags Activity\n\nStar\n\nNotifications\n\n# hackertarget/pcap-did-what\n\nThis commit does not belong to any branch on this repository, and may belong\nto a fork outside of the repository.\n\n1 Branch\n\n0 Tags\n\n## Folders and files\n\nName| Name| Last commit message| Last commit date  \n---|---|---|---  \n  \n## Latest commit\n\npeter-hackertargetUpdated README4f7c2b6 \u00b7\n\n## History\n\n4 Commits  \n  \n### grafana-docker\n\n|\n\n### grafana-docker\n\n| Initial commit  \n  \n### zeek-docker\n\n|\n\n### zeek-docker\n\n| Initial commit  \n  \n### LICENSE\n\n|\n\n### LICENSE\n\n| Initial commit  \n  \n### README.md\n\n|\n\n### README.md\n\n| Updated README  \n  \n## Repository files navigation\n\n# Zeek & Grafana Integration for Network Monitoring\n\nThis repository provides a quick way to get started using Zeek with a\npractical use case. The focus is to analyse a network pcap and enable easy\nvisual analysis using Grafana Charts. The mini project consists of three\nparts.\n\n  1. Custom Zeek Docker build that generates zeek log files with GeoIP, ASN and JA3 / JA4 fingerprints.\n\n  2. Python Script to convert zeek log files to an SQLite database.\n\n  3. Custom Grafana Docker build with a pre-configured dashboard for analysing Zeek Data.\n\nKeeping this project simple and broken up into three parts should help both\nZeek newcomers and those with more experience get up and running quickly.\nWorking from these base images it would be an easy task to add other packages,\nand extend the dashboard to suit your own environment or use case.\n\nA two part article is available that goes into more detail about the project\nand getting started.\n\nZeek with GeoIP, ASN & JA4 in 5 minutes\n\nZeek Dashboard using Grafana\n\n## Overview\n\nThe project is structured to use Docker containers for easy setup and\nportability. It includes a customized Zeek container for log generation and a\nGrafana container for data visualization.\n\n### File Structure\n\n  * Dockerfile: Located at ./pcap-did-what/zeek-docker/Dockerfile, this file creates a Docker container based on the official Zeek image. It includes the installation of necessary packages for JA3 / JA4 fingerprinting and GeoIP, with a custom script for ASN enrichment.\n  * local_asn.zeek: ./pcap-did-what/zeek-docker/local_asn.zeek, a small zeek script to add ASN information to the conn.log. The script uses the builtin zeek function (lookup_autonomous_system).\n  * docker-compose.yml: Found in ./pcap-did-what/grafana-docker/docker-compose.yml, this Docker Compose file sets up the Grafana container, configuring it to use a custom SQLite datasource and including volumes for persistent storage and configuration.\n  * dashboard.yml: Located at ./pcap-did-what/grafana-docker/dashboards/dashboard.yml, this configuration file specifies the dashboard provider settings for Grafana.\n  * datasource.yml: Found in ./pcap-did-what/grafana-docker/datasources/datasource.yml, this file configures Grafana to use an SQLite database as the data source, pointing to the Zeek logs stored in SQLite format.\n\n## Usage\n\nTo get started with this setup, ensure you have Docker and Docker Compose\ninstalled on your system.\n\nYou will also need the MaxMind GeoIP and ASN databases, this requires\nregistration (free) and a download of the two files.\n\nFollow these steps to deploy the environment:\n\n  1. Clone this repository\n\ngit clone https://github.com/yourusername/pcap-did-what.git\n\n  2. Build Zeek Docker Image\n\nFrom the ./pcap-did-what/ build zeek image.\n\n    \n    \n    cd zeek-docker sudo docker build -t zeek-custom .\n\nRunning the docker will drop you into bash. From bash it is possible to\ngenerate the zeek logs and convert them to sqlite db.\n\n    \n    \n    # zeek -C -r /data/test.pcap local # zeek-to-sqlite.py\n\n  3. Start the Grafana Container\n\nUse docker-compose to start the Grafana container:\n\n    \n    \n    cd ../grafana-docker sudo docker-compose up -d\n\n  4. Accessing Grafana: Once the containers are up and running, access the Grafana dashboard through your web browser:\n\nhttp://localhost:3000\n\nUse the default Grafana credentials (admin/admin) unless changed in the\nconfiguration. The dashboard should be loaded but there will be likely no data\nunless the zeek_log.db file has been generated and is in place.\n\n## Customization and Notes\n\n  * You can modify the Dockerfile to include additional Zeek scripts or alter the existing configuration to suit your network analysis requirements.\n  * The Grafana dashboard and data source configurations can be adjusted in dashboard.yml and datasource.yml respectively, allowing for further customization of how data is displayed.\n  * zeek-to-sqlite.py uses a hardcoded /data/ path to match the build. Modify this as required.\n  * The local_asn.zeek script could be used to learn more about zeek scripting or extend it to populate other log files.\n\n## Credits\n\nThanks to Zeek and Grafana for making high quality open source software.\n\nAlso, thanks to Christos @ Threat Hunting Tails for the ASN information and\nasn.zeek script.\n\n## About\n\nAnalyze pcaps with Zeek and a Grafana Dashboard\n\n### Resources\n\nReadme\n\n### License\n\nMIT license\n\nActivity\n\nCustom properties\n\n### Stars\n\n1 star\n\n### Watchers\n\n1 watching\n\n### Forks\n\n0 forks\n\nReport repository\n\n## Releases\n\nNo releases published\n\n## Packages 0\n\nNo packages published\n\n## Languages\n\n  * Python 56.2%\n  * Dockerfile 27.0%\n  * Zeek 16.8%\n\n## Footer\n\n\u00a9 2024 GitHub, Inc.\n\nYou can\u2019t perform that action at this time.\n\n", "frontpage": false}
