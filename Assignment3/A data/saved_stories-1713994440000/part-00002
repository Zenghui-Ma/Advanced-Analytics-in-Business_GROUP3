{"aid": "40144896", "title": "Hackers infect users of antivirus service that delivered updates over HTTP", "url": "https://arstechnica.com/security/2024/04/hackers-infect-users-of-antivirus-service-that-delivered-updates-over-http/", "domain": "arstechnica.com", "votes": 8, "user": "LinuxBender", "posted_at": "2024-04-24 14:36:35", "comments": 2, "source_title": "Hackers infect users of antivirus service that delivered updates over HTTP", "source_text": "Hackers infect users of antivirus service that delivered updates over HTTP | Ars Technica\n\nSkip to main content\n\nSubscribe\n\nClose\n\n### Navigate\n\n  * Store\n  * Subscribe\n  * Videos\n  * Features\n  * Reviews\n\n  * RSS Feeds\n  * Mobile Site\n\n  * About Ars\n  * Staff Directory\n  * Contact Us\n\n  * Advertise with Ars\n  * Reprints\n\n### Filter by topic\n\n  * Biz & IT\n  * Tech\n  * Science\n  * Policy\n  * Cars\n  * Gaming & Culture\n  * Store\n  * Forums\n\n### Settings\n\nFront page layout\n\nGrid\n\nList\n\nSite theme\n\nlight\n\ndark\n\nSign in\n\n#### GOT HTTPS? \u2014\n\n# Hackers infect users of antivirus service that delivered updates over HTTP\n\n## eScan AV updates were delivered over HTTP for five years.\n\nDan Goodin - 4/23/2024, 9:03 PM\n\nEnlarge\n\nGetty Images\n\n#### reader comments\n\n23\n\nHackers abused an antivirus service for five years in order to infect end\nusers with malware. The attack worked because the service delivered updates\nover HTTP, a protocol vulnerable to attacks that corrupt or tamper with data\nas it travels over the Internet.\n\nThe unknown hackers, who may have ties to the North Korean government, pulled\noff this feat by performing a man-in-the-middle (MitM) attack that replaced\nthe genuine update with a file that installed an advanced backdoor instead,\nsaid researchers from security firm Avast today.\n\neScan, an AV service headquartered in India, has delivered updates over HTTP\nsince at least 2019, Avast researchers reported. This protocol presented a\nvaluable opportunity for installing the malware, which is tracked in security\ncircles under the name GuptiMiner.\n\n\"This sophisticated operation has been performing MitM attacks targeting an\nupdate mechanism of the eScan antivirus vendor,\" Avast researchers Jan Rub\u00edn\nand Mil\u00e1nek wrote. \"We disclosed the security vulnerability to both eScan and\nthe India CERT and received confirmation on 2023-07-31 from eScan that the\nissue was fixed and successfully resolved.\"\n\n## Complex infection chain\n\nThe complex infection chain started when eScan applications checked in with\nthe eScan update system. The threat actors then performed a MitM attack that\nallowed them to intercept the package sent by the update server and replace it\nwith a corrupted one that contained code to install GuptiMiner. The Avast\nresearchers still don\u2019t know precisely how the attackers were able to perform\nthe interception. They suspect targeted networks may already have been\ncompromised somehow to route traffic to a malicious intermediary.\n\nTo lower the chances of detection, the infection file used DLL hijacking, a\ntechnique that replaces legitimate dynamic link library files used by most\nMicrosoft apps with maliciously crafted ones that use the same file name. For\nadded stealth, the infection chain also relied on a custom domain name system\n(DNS) server that allowed it to use legitimate domain names when connecting to\nattacker-controlled channels.\n\nLast year, the attackers abandoned the DNS technique and replaced it with\nanother obfuscation technique known as IP address masking. This involved the\nfollowing steps:\n\nAdvertisement\n\n>   1. Obtain an IP address of a hardcoded server name registered to the\n> attacker by standard use of the gethostbyname API function\n>   2. For that server, two IP addresses are returned\u2014the first is an IP\n> address which is a masked address, and the second one denotes an available\n> payload version and starts with 23.195. as its first two octets\n>   3. If the version is newer than the current one, the masked IP address is\n> de-masked, resulting in a real command-and-control (C&C) IP address\n>   4. The real C&C IP address is used along with a hardcoded constant string\n> (part of a URL path) to download a file containing malicious shellcode\n>\n\nSome variants of the infection chain stashed the malicious code inside an\nimage file to make them harder to detect. The variants also installed a custom\nroot TLS certificate that satisfied requirements by some targeted systems that\nall apps must be digitally signed before being installed.\n\nThe payload contained multiple backdoors that were activated when installed on\nlarge networks. Curiously, the update also delivered XMRig, an open source\npackage for mining cryptocurrency.\n\nEnlarge / The GuptiMiner infection chain.\n\nAvast\n\nGuptiMiner has circulated since at least 2018 and has undergone multiple\nrevisions. One searched compromised networks for systems running Windows 7 and\nWindows Server 2008, presumably to deliver exploits that worked on those\nearlier versions. Another provided an interface for installing special-purpose\nmodules that could be customized for different victims. (This version also\nscanned the local system for stored private keys and cryptocurrency wallets.)\n\n### Further Reading\n\nMeet the three North Korean hacking groups funding the country\u2019s weapons\nprograms\n\nThe researchers were surprised that malware that took such pains to fly under\nthe radar would also install a cryptocurrency miner, which by nature is\nusually easy to detect. One possibility is the attackers' possible connection\nto Kimsuky, the tracking name for a group backed by the North Korean\ngovernment. Over the years, North Korea\u2019s government has generated billions of\ndollars in cryptocurrency through malware installed on the devices of\nunwitting victims. The researchers made the possible connection after finding\nsimilarities between a known Kimsuky keylogger and code fragments used during\nthe GuptiMiner operation.\n\nThe GuptiMiner attack is notable for exposing major shortcomings in eScan that\nwent unnoticed for at least five years. Besides not delivering updates over\nHTTPS, a medium not susceptible to MitM attacks, eScan also failed to enforce\ndigital signing to ensure updates hadn\u2019t been tampered with before being\ninstalled. Representatives of eScan didn\u2019t respond to an email asking why\nengineers designed the update process this way.\n\nPeople who use or have used eScan should check the Avast post for details on\nwhether their systems are infected. It\u2019s likely that most reputable AV\nscanners will also detect this infection.\n\n### Ars Video\n\n### How Lighting Design In The Callisto Protocol Elevates The Horror\n\n#### reader comments\n\n23\n\nDan Goodin Dan Goodin is Senior Security Editor at Ars Technica, where he\noversees coverage of malware, computer espionage, botnets, hardware hacking,\nencryption, and passwords. In his spare time, he enjoys gardening, cooking,\nand following the independent music scene.\n\nAdvertisement\n\n### Channel Ars Technica\n\n#### Unsolved Mysteries Of Quantum Leap With Donald P. Bellisario\n\nToday \"Quantum Leap\" series creator Donald P. Bellisario joins Ars Technica to\nanswer once and for all the lingering questions we have about his enduringly\npopular show. Was Dr. Sam Beckett really leaping between all those time\nperiods and people or did he simply imagine it all? What do people in the\nwaiting room do while Sam is in their bodies? What happens to Sam's loyal ally\nAl? 30 years following the series finale, answers to these mysteries and more\nawait.\n\n  * ##### Unsolved Mysteries Of Quantum Leap With Donald P. Bellisario\n\n  * ##### Unsolved Mysteries Of Warhammer 40K With Author Dan Abnett\n\n  * ##### SITREP: F-16 replacement search a signal of F-35 fail?\n\n  * ##### Sitrep: Boeing 707\n\n  * ##### Steve Burke of GamersNexus Reacts To Their Top 1000 Comments On YouTube\n\n  * ##### Modern Vintage Gamer Reacts To His Top 1000 Comments On YouTube\n\n  * ##### How The NES Conquered A Skeptical America In 1985\n\n  * ##### Scott Manley Reacts To His Top 1000 YouTube Comments\n\n  * ##### How Horror Works in Amnesia: Rebirth, Soma and Amnesia: The Dark Descent\n\n  * ##### LGR's Clint Basinger Reacts To His Top 1000 YouTube Comments\n\n  * ##### The F-35's next tech upgrade\n\n  * ##### How One Gameplay Decision Changed Diablo Forever\n\n  * ##### Unsolved Mortal Kombat Mysteries With Dominic Cianciolo From NetherRealm Studios\n\n  * ##### US Navy Gets an Italian Accent\n\n  * ##### How Amazon\u2019s \u201cUndone\u201d Animates Dreams With Rotoscoping And Oil Paints\n\n  * ##### Fighter Pilot Breaks Down Every Button in an F-15 Cockpit\n\n  * ##### How NBA JAM Became A Billion-Dollar Slam Dunk\n\n  * ##### Linus \"Tech Tips\" Sebastian Reacts to His Top 1000 YouTube Comments\n\n  * ##### How Alan Wake Was Rebuilt 3 Years Into Development\n\n  * ##### How Prince of Persia Defeated Apple II's Memory Limitations\n\n  * ##### How Crash Bandicoot Hacked The Original Playstation\n\n  * ##### Myst: The challenges of CD-ROM | War Stories\n\n  * ##### Markiplier Reacts To His Top 1000 YouTube Comments\n\n  * ##### How Mind Control Saved Oddworld: Abe's Oddysee\n\n  * ##### Bioware answers unsolved mysteries of the Mass Effect universe\n\n  * ##### Civilization: It's good to take turns | War Stories\n\n  * ##### SITREP: DOD Resets Ballistic Missile Interceptor program\n\n  * ##### Warframe's Rebecca Ford reviews your characters\n\n  * ##### Subnautica: A world without guns | War Stories\n\n  * ##### How Slay the Spire\u2019s Original Interface Almost Killed the Game | War Stories\n\n  * ##### Amnesia: The Dark Descent - The horror facade | War Stories\n\n  * ##### Command & Conquer: Tiberian Sun | War Stories\n\n  * ##### Blade Runner: Skinjobs, voxels, and future noir | War Stories\n\n  * ##### Dead Space: The Drag Tentacle | War Stories\n\n  * ##### Teach the Controversy: Flat Earthers\n\n  * ##### Delta V: The Burgeoning World of Small Rockets, Paul Allen's Huge Plane, and SpaceX Gets a Crucial Green-light\n\n  * ##### Chris Hadfield explains his 'Space Oddity' video\n\n  * ##### The Greatest Leap, Episode 1: Risk\n\n  * ##### Ultima Online: The Virtual Ecology | War Stories\n\nMore videos\n\n\u2190 Previous story Next story \u2192\n\n### Related Stories\n\n### Today on Ars\n\nCNMN Collection WIRED Media Group \u00a9 2024 Cond\u00e9 Nast. All rights reserved. Use of and/or registration on any portion of this site constitutes acceptance of our User Agreement (updated 1/1/20) and Privacy Policy and Cookie Statement (updated 1/1/20) and Ars Technica Addendum (effective 8/21/2018). Ars may earn compensation on sales from links on this site. Read our affiliate link policy. Your California Privacy Rights | Manage Preferences The material on this site may not be reproduced, distributed, transmitted, cached or otherwise used, except with the prior written permission of Cond\u00e9 Nast. Ad Choices\n\n## We Care About Your Privacy\n\nWe and our 167 partners store and/or access information on a device, such as\nunique IDs in cookies to process personal data. You may accept or manage your\nchoices by clicking below or at any time in the privacy policy page. These\nchoices will be signaled to our partners and will not affect browsing\ndata.More information about your privacy\n\n### We and our partners process data to provide:\n\nUse precise geolocation data. Actively scan device characteristics for\nidentification. Store and/or access information on a device. Personalised\nadvertising and content, advertising and content measurement, audience\nresearch and services development.\n\n", "frontpage": true}
