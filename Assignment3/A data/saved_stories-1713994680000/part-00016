{"aid": "40145660", "title": "Assessing the Y, and How, of the XZ Utils incident", "url": "https://securelist.com/xz-backdoor-story-part-2-social-engineering/112476/", "domain": "securelist.com", "votes": 2, "user": "netol", "posted_at": "2024-04-24 15:36:37", "comments": 0, "source_title": "Social engineering aspect of the XZ incident", "source_text": "Social engineering aspect of the XZ incident | Securelist\n\nby Kaspersky\n\n  * CompanyAccount\n  * Get In Touch\n  * Dark mode off\n  * English\n\n    * Russian\n    * Spanish\n\n  * Subscribe Dark mode off Login\n  * Securelist menu\n  * English\n\n    * Russian\n    * Spanish\n  * Existing Customers\n\n    * Personal\n\n      * My Kaspersky\n      * Renew your product\n      * Update your product\n      * Customer support\n    * Business\n\n      * KSOS portal\n      * Kaspersky Business Hub\n      * Technical Support\n      * Knowledge Base\n      * Renew License\n  * Home\n\n    * Products\n    * Trials&Update\n    * Resource Center\n  * Business\n\n    * Kaspersky Next\n    * Small Business (1-50 employees)\n    * Medium Business (51-999 employees)\n    * Enterprise (1000+ employees)\n  * Securelist\n  * Threats\n\n    * Financial threats\n    * Mobile threats\n    * Web threats\n    * Secure environment (IoT)\n    * Vulnerabilities and exploits\n    * Spam and Phishing\n    * Industrial threats\n  * Categories\n\n    * APT reports\n    * Incidents\n    * Research\n    * Malware reports\n    * Spam and phishing reports\n    * Publications\n    * Kaspersky Security Bulletin\n  * Archive\n  * All Tags\n  * APT Logbook\n  * Webinars\n  * Statistics\n  * Encyclopedia\n  * Threats descriptions\n  * KSB 2021\n  * About Us\n\n    * Company\n    * Transparency\n    * Corporate News\n    * Press Center\n    * Careers\n    * Sponsorships\n    * Policy Blog\n    * Contacts\n  * Partners\n\n    * Find a Partner\n    * Partner Program\n\nContent menu Close\n\nSubscribe\n\nIncidents\n\n# Assessing the Y, and How, of the XZ Utils incident\n\nIncidents\n\n24 Apr 2024\n\n10 minute read\n\nTable of Contents\n\n  * A Singaporean guy, an Indian guy, and a German guy walk into a bar...\n  * Jia Tan Identity and Activity\n  * Summer 2022 Pressure to Add a Maintainer\n  * Spring 2024 Pressure to Import Backdoored Code to Debian\n  * What NeXZt?\n\nAuthors\n\n  * GReAT\n\n## Social engineering for open-source supply chain attack profit\n\nHigh-end APT groups perform highly interesting social engineering campaigns in\norder to penetrate well-protected targets. For example, carefully constructed\nforum responses on precision targeted accounts and follow-up \u201cout-of-band\u201d\ninteractions regarding underground rail system simulator software helped\ndeliver Green Lambert implants in the Middle East. And, in what seems to be a\nlearned approach, the XZ Utils project penetration was likely a patient,\nmulti-year approach, both planned in advance but somewhat clumsily executed.\n\nThis recently exposed offensive effort slowly introduced a small cast of\nremote characters, communications, and malicious code to the more than decade\nold open-source project XZ Utils and its maintainer, Lasse Collin. The\nbackdoor code was inserted in February and March 2024, mostly by Jia Cheong\nTan, likely a fictitious identity. The end goal was to covertly implement an\nexclusive use backdoor in sshd by targeting the XZ Utils build process, and\npush the backdoored code to the major Linux distributions as a part of a\nlarge-scale supply chain attack.\n\nWhile this highly targeted and interactive social engineering approach might\nnot be completely novel, it is extraordinary. Also extraordinary is the\nstunningly subtle insertion of malicious code leveraging the build process in\nplain sight. This build process focus during a major supply chain attack is\ncomparable only to the CozyDuke/DarkHalo/APT29/NOBELIUM Solarwinds compromise\nand the SUNSPOT implant\u2019s cunning and persistent presence \u2013 its monitoring\ncapability for the execution of a Solarwinds build, and its malicious code\ninsertion during any Solarwinds build execution. Only this time, it\u2019s human\ninvolvement in the build process.\n\nIt\u2019s notable that one of the key differentiators of the Solarwinds incident\nfrom prior supply chain attacks was the adversary\u2019s covert, prolonged access\nto the source/development environment. In this XZ Utils incident, this\nprolonged access was obtained via social engineering and extended with\nfictitious human identity interactions in plain sight.\n\nOne of the best publicly available chronological timelines on the social\nengineering side of the XZ Utils incident is posted by Russ Cox, currently a\nGoogle researcher. It\u2019s highly recommended reading. Notably, Cox writes: \u201cThis\npost is a detailed timeline that I have constructed of the social engineering\naspect of the attack, which appears to date back to late 2021.\u201d\n\n## A Singaporean guy, an Indian guy, and a German guy walk into a bar...\n\nThree identities pressure XZ Utils creator and maintainer Lasse Collin in\nsummer 2022 to provoke an open-source code project handover: Jia Tan/Jia\nCheong Tan, Dennis Ens, and Jigar Kumar. These identities are made up of a\nGitHub account, three free email accounts with similar name schemes, an IRC\nand Ubuntu One account, email communications on XZ Utils developer mailing\nlists and downstream maintainers, and code. Their goal was to grant full\naccess to XZ Utils source code to Jia Tan and subtly introduce malicious code\ninto XZ Utils \u2013 the identities even interact with one another on mail threads,\ncomplaining about the need to replace Lasse Collin as the XZ Utils maintainer.\n\nNote that the geographic dispersion of fictitious identities is a bit forced\nhere, perhaps to dispel hints of coordination: Singaporean or Malaysian\n(possibly of a Hokkien dialect), northern European, and Indian. Misspellings\nand grammar mistakes are similar across the three identities\u2019 communications.\nThe \u201cJia Tan\u201d identity seems a bit forced as well \u2013 the only public\ngeolocation data is a Singaporean VPN exit node that the identity may have\nused on March 29 to access the XZ Utils Libera IRC chat. If constructing a\nfictitious identity, using that particular exit node would definitely be a\nselected resource.\n\nOur pDNS confirms this IP as a Witopia VPN exit. While we might expect a\n\u201cjiat75\u201d or \u201cjiatan018\u201d username for the \u201cJia Tan\u201d Libera IRC account, this\none in the screenshot above may have been used on March 29, 2024 by the\n\u201cJiaT75\u201d actor.\n\nOne additional identity, Hans Jansen, introduced a June 2023 performance\noptimization into the XZ Utils source, committed by Collin, and later\nleveraged by jiaT75\u2019s backdoor code. Jia Tan gleefully accepted the proposed\nIFUNC additions: \u201cThanks for the PR and the helpful links! Overall this seems\nlike a nice improvement to our function-picking strategy for CRC64. It will\nlikely be useful when we implement CRC32 CLMUL too :)\u201d.\n\nThis pull request is the Jansen identities\u2019 only interaction with the XZ Utils\nproject itself. And, unlike the other two identities, the Jansen account is\nnot used to pressure Collin to turn over XZ Utils maintenance. Instead, the\nHans Jansen identity provided the code and then disappeared. Nine months\nlater, following the backdoor code insertion, Jansen urged a major Linux\nvendor in the supply chain to incorporate the backdoored XZ Utils code in\ntheir distribution. The identity resurfaced on a Debian bug report on March\n24, 2024, creating an opportunity to generate urgency in including the\nbackdoored code in the Debian distribution.\n\n## Jia Tan Identity and Activity\n\nThe Jia Cheong Tan (JiaT75) GitHub account, eventually promoted to co-\nmaintainer of XZ Utils, which inserted the malicious backdoor code, was\ncreated January 26, 2021. JiaT75 was not exclusively involved in XZ Utils,\nhaving authored over 500 patches to multiple GitHub projects going back to\nearly 2022.\n\n  * oss-fuzz\n  * cpp-docs\n  * wasmtime\n  * xz\n\nThese innocuous patches helped to build the identity of JiaT75 as a legitimate\nopen source contributor and potential maintainer for the XZ Utils project. The\npatch efforts helped to establish a relationship with Lasse Collin as well.\n\nThe first JiaT75 code contribution to XZ Utils occurred on October 29, 2021.\nIt was sent to the xz-devel mailing list. It was a very simple editor config\nfile introduction. Following this initial innocuous addition, over the next\ntwo years, JiaT75 authored hundreds of changes for the XZ project.\n\nYes, JiaT75 contributed code on both weekends and what appear to be workdays.\nHowever, an interesting anomaly is that the 2024 malicious commits occur out\nof sync with many previous commits. A Huntress researcher going by the alias\n\u201cAlden\u201d posted a visualization of the malicious Jia Tan commits to XZ Utils.\nJiaT75 commits the malicious code completely out of sync with prior work times\non Feb 23\u201326, and March 8 and 9, 2024.\n\nThe time differences for the malicious commits is noticeable. What might this\nanomaly suggest? We speculate on several possibilities:\n\n  * the JiaT75 account was used by a second party to insert the malicious code, either known or unknown to the individual contributor.\n  * the JiaT75 individual contributor was rushed to commit the malicious backdoor code.\n  * the JiaT75 account was run by a team of individuals and one part of the team needed to work without interruption outside of the usual constructed work day.\n\nEspecially devious is the manner in which the obfuscated backdoor code is\nintroduced in multiple separate pieces by JiaT75. Even though it was open-\nsource, the bulk of the backdoor does not show up in the XZ source-code tree,\nis not human readable, and was not recognized.\n\n## Summer 2022 Pressure to Add a Maintainer\n\nMultiple identities of interest pressured Lasse Collin to add a maintainer\nover the summer of 2022. The intensity of pressure on Collin varies per\naccount, but they all create opportunities to pressure Collin and interact.\n\nName| GitHub Account| Email| Creation  \n---|---|---|---  \nJia Tan/Jia Cheong Tan| JiaT75| jiat0218@gmail.com| January 26, 2021  \nDennis Ens| \u2013| dennis3ns@gmail.com| \u2013  \nJigar Kumar| \u2013| jigarkumar17@protonmail.com| \u2013  \n  \nIf we take the first interaction on the xz-devel mailing list as the start of\nthe campaign, Jia Tan sent a superficial code patch on September 29, 2021.\nThis timestamp is eight months after the github account creation date. This\ninitial contribution is harmless, but establishes this identity within the\nopen-source project.\n\nA year later, Jigar Kumar pressured Lasse Collin to hand over access to Jia\nTan over the spring and summer of 2022 in six chiding comments over two\ndifferent threads.\n\nWed, 27 Apr 2022 11:42:57 -0700| Re: [xz-devel] [PATCH] String to filter and\nfilter to string  \n---|---  \n\u201cYour efforts are good but based on the slow release schedule it will\nunfortunatly be years until the community actually gets this quality of life\nfeature.\u201d  \nThu, 28 Apr 2022 10:10:48 -0700| Re: [xz-devel] [PATCH] String to filter and\nfilter to string  \n\u201cPatches spend years on this mailing list. 5.2.0 release was 7 years ago.\nThere is no reason to think anything is coming soon.\u201d  \nFri, 27 May 2022 10:49:47 -0700| Re: [xz-devel] [PATCH] String to filter and\nfilter to string  \n\u201cOver 1 month and no closer to being merged. Not a suprise.\u201d  \nTue, 07 Jun 2022 09:00:18 -0700| Re: [xz-devel] XZ for Java  \n\u201cProgress will not happen until there is new maintainer. XZ for C has sparse\ncommit log too. Dennis you are better off waiting until new maintainer happens\nor fork yourself. Submitting patches here has no purpose these days. The\ncurrent maintainer lost interest or doesn\u2019t care to maintain anymore. It is\nsad to see for a repo like this.\u201d  \nTue, 14 Jun 2022 11:16:07 -0700| Re: [xz-devel] XZ for Java  \n\u201cWith your current rate, I very doubt to see 5.4.0 release this year. The only\nprogress since april has been small changes to test code. You ignore the many\npatches bit rotting away on this mailing list. Right now you choke your repo.\nWhy wait until 5.4.0 to change maintainer? Why delay what your repo needs?\u201d  \nWed, 22 Jun 2022 10:05:06 -0700| Re: [xz-devel] [PATCH] String to filter and\nfilter to string  \n\u201cIs there any progress on this? Jia I see you have recent commits. Why can\u2019t\nyou commit this yourself?\u201d  \n  \nThe Dennis Ens identity sets up a thread of their own, and follows up by\npressuring maintainer Collin in one particularly forceful and obnoxious\nmessage to the list. The identity leverages a personal vulnerability that\nCollin shared on this thread. The Jigar Kumar identity responds twice to this\nthread, bitterly complaining about the maintainer: \u201cDennis you are better off\nwaiting until new maintainer happens or fork yourself.\u201d\n\nThu, 19 May 2022 12:26:03 -0700| XZ for Java  \n---|---  \n\u201cIs XZ for Java still maintained? I asked a question here a week ago and have\nnot heard back. When I view the git log I can see it has not updated in over a\nyear. I am looking for things like multithreaded encoding / decoding and a few\nupdates that Brett Okken had submitted (but are still waiting for merge).\nShould I add these things to only my local version, or is there a plan for\nthese things in the future?\u201d  \nTue, 21 Jun 2022 13:24:47 -0700| Re: [xz-devel] XZ for Java  \nI am sorry about your mental health issues, but its important to be aware of\nyour own limits. I get that this is a hobby project for all contributors, but\nthe community desires more. Why not pass on maintainership for XZ for C so you\ncan give XZ for Java more attention? Or pass on XZ for Java to someone else to\nfocus on XZ for C? Trying to maintain both means that neither are maintained\nwell.  \n  \nReflecting on these data points still leads us to shaky ground. Until more\ndetails are publicized, we are left with speculation:\n\n  * In a three-year project, a small team successfully penetrated the XZ Utils codebase with a slow and low-pressure campaign. They manipulated the introduction of a malicious actor into the trusted position of code co-maintainer. They then initiated and attempted to speed up the process of distributing malicious code targeting sshd to major vendor Linux distributions\n  * In a three-year project, an individual successfully penetrated the XZ Utils codebase with a slow and low-pressure campaign. The one individual managed several identities to manipulate their own introduction into the trusted position of open source co-maintainer. They then initiated and attempted to speed up the process of distributing malicious code targeting sshd to major vendor Linux distributions\n  * In an extremely short timeframe in early 2024, a small team successfully manipulated an individual (Jia Tan) that legitimately earned access to an interesting open-source project as code maintainer. Two other individuals (Jigar Kumar, Dennis Ens) may have coincidentally complained and pressured Collin to hand over the maintainer role. That leveraged individual began inserting malicious code into the project over the course of a couple of weeks.\n\n## Spring 2024 Pressure to Import Backdoored Code to Debian\n\nSeveral identities attempted to pressure Debian maintainers to import the\nbackdoored upstream XZ Utils code to their distribution in March 2024. The\nHans Jansen identity created a Debian report log on March 25, 2024 to raise\nurgency to include the backdoored code: \u201cDear mentors, I am looking for a\nsponsor for my package \u201cxz-utils\u201d.\u201d\n\nName| Email address  \n---|---  \nHans Jansen| hansjansen162@outlook.com  \nkrygorin4545| krygorin4545@proton.me  \nmisoeater91@tutamail.com| misoeater91@tutamail.com  \n  \nThe thread was responded to within a day by additional identities using the\nemail address scheme name-number@freeservice[.]com:\n\nDate: Tue, 26 Mar 2024 19:27:47 +0000| From: krygorin4545\n<krygorin4545@proton.me>  \n---|---  \nSubject: Re: RFS: xz-utils/5.6.1-0.1 [NMU] \u2014 XZ-format compression utilities  \nAlso seeing this bug. Extra valgrind output causes some failed tests for me.\nLooks like the new version will resolve it. Would like this new version so I\ncan continue work  \nDate: Tue, 26 Mar 2024 22:50:54 +0100 (CET)| From: misoeater91@tutamail.com  \nSubject: Re: RFS: xz-utils/5.6.1-0.1 [NMU] \u2014 XZ-format compression  \nI noticed this last week and almost made a valgrind bug. Glad to see it being\nfixed. Thanks Hans!  \n  \nThe code changes received pushback from Debian contributors:\n\nDate: Tue, 26 Mar 2024 19:27:47 +0000| From: krygorin4545\n<krygorin4545@proton.me>  \n---|---  \nSubject: new upstream versions as NMU vs. xz maintenance  \nVery much *not* a fan of NMUs doing large changes such as new upstream\nversions.But this does give us the question, what\u2019s up with the maintenance of\nxz-utils? Same as with the lack of security uploads of git, which you also\nmaintain, are you active?  \nAre you well?  \n  \nTo which one of these likely sock puppet accounts almost immediately\nresponded, in order to counteract any distraction from pushing the changes:\n\nDate: Wed, 27 Mar 2024 12:46:32 +0000| From: krygorin4545\n<krygorin4545@proton.me>  \n---|---  \nSubject: Re: Bug#1067708: new upstream versions as NMU vs. xz maintenance  \nInstead of having a policy debate over who is proper to do this upload, can\nthis just be fixed? The named maintainer hasn\u2019t done an upload in 5 years.\nFedora considered this a serious bug and fixed it weeks ago (). Fixing a\nvalgrind break across many apps throughout Debian is the priority here.  \n  \n## What NeXZt?\n\nClearly social engineering techniques have much lower technical requirements\nto gain full access to development environments than what we saw with prior\nsupply chain attacks like the Solarwinds, M.E.Doc ExPetya, and ASUS\nShadowHammer incidents. We have presented and compared these particular supply\nchain attacks, their techniques, and their complexities, at prior SAS events\n[registration required], distilling an assessment into a manageable table.\n\nUnfortunately, we expect more open-source project incidents like XZ Utils\ncompromise to be exposed in the months to come. As a matter of fact, at the\ntime of this writing, the Open Source Security Foundation (OSSF) has\nidentified similar social engineering-driven incidents in other open-source\nprojects, and claims that the XZ Utils social engineering effort is highly\nlikely not an isolated incident.\n\n  * Social engineering\n  * Supply-chain attack\n  * Targeted attacks\n  * XZ\n\nAuthors\n\n  * GReAT\n\nAssessing the Y, and How, of the XZ Utils incident\n\nTable of Contents\n\n  * A Singaporean guy, an Indian guy, and a German guy walk into a bar...\n  * Jia Tan Identity and Activity\n  * Summer 2022 Pressure to Add a Maintainer\n  * Spring 2024 Pressure to Import Backdoored Code to Debian\n  * What NeXZt?\n\nGReAT webinars\n\n13 May 2021, 1:00pm\n\n### GReAT Ideas. Balalaika Edition\n\n  * Boris Larin\n  * Denis Legezo\n\n26 Feb 2021, 12:00pm\n\n### GReAT Ideas. Green Tea Edition\n\n  * John Hultquist\n  * Brian Bartholomew\n  * Suguru Ishimaru\n  * Vitaly Kamluk\n  * Seongsu Park\n  * Yusuke Niwa\n  * Motohiko Sato\n\n17 Jun 2020, 1:00pm\n\n### GReAT Ideas. Powered by SAS: malware attribution and next-gen IoT\nhoneypots\n\n  * Marco Preuss\n  * Denis Legezo\n  * Costin Raiu\n  * Kurt Baumgartner\n  * Dan Demeter\n  * Yaroslav Shmelev\n\n26 Aug 2020, 2:00pm\n\n### GReAT Ideas. Powered by SAS: threat actors advance on new fronts\n\n  * Ivan Kwiatkowski\n  * Maher Yamout\n  * Noushin Shabab\n  * Pierre Delcher\n  * F\u00e9lix Aime\n  * Giampaolo Dedola\n  * Santiago Pontiroli\n\n22 Jul 2020, 2:00pm\n\n### GReAT Ideas. Powered by SAS: threat hunting and new techniques\n\n  * Dmitry Bestuzhev\n  * Costin Raiu\n  * Pierre Delcher\n  * Brian Bartholomew\n  * Boris Larin\n  * Ariel Jungheit\n  * Fabio Assolini\n\nFrom the same authors\n\n### DuneQuixote campaign targets Middle Eastern entities with \u201cCR4T\u201d malware\n\n### XZ backdoor story \u2013 Initial analysis\n\n### Android malware, Android malware and more Android malware\n\n### Coyote: A multi-stage banking Trojan abusing the Squirrel installer\n\n### FakeSG campaign, Akira ransomware and AMOS macOS stealer\n\n##### Subscribe to our weekly e-mails\n\nThe hottest research right in your inbox\n\nIn the same category\n\n### XZ backdoor story \u2013 Initial analysis\n\n### A hack in hand is worth two in the bush\n\n### QBot banker delivered through business correspondence\n\n### Not just an infostealer: Gopuram backdoor deployed through 3CX supply\nchain attack\n\n### CVE-2022-41040 and CVE-2022-41082 \u2013 zero-days in MS Exchange\n\n##### Latest Posts\n\nMalware descriptions\n\n### SoumniBot: the new Android banker\u2019s unique techniques\n\n  * Dmitry Kalinin\n\nMalware descriptions\n\n### Using the LockBit builder to generate targeted ransomware\n\n  * Eduardo Ovalle\n  * Francesco Figurelli\n  * Cristian Souza\n  * Ashley Mu\u00f1oz\n\nIncidents\n\n### XZ backdoor story \u2013 Initial analysis\n\n  * GReAT\n\nMalware descriptions\n\n### DinodasRAT Linux implant targeting entities worldwide\n\n  * Anderson Leite\n  * Lisandro Ubiedo\n\n##### Latest Webinars\n\nTechnologies and services\n\n11 Dec 2023, 4:00pm 60 min\n\n### The Future of AI in cybersecurity: what to expect in 2024\n\n  * Vladimir Dashchenko\n  * Victor Sergeev\n  * Vladislav Tushkanov\n  * Dennis Kipker\n\nThreat intelligence and IR\n\n30 Nov 2023, 4:00pm 70 min\n\n### Responding to a data breach: a step-by-step guide\n\n  * Anna Pavlovskaya\n\nCyberthreat talks\n\n14 Nov 2023, 4:00pm 60 min\n\n### 2024 Advanced persistent threat predictions\n\n  * Igor Kuznetsov\n  * David Emm\n  * Marc Rivero\n  * Dan Demeter\n  * Sherif Magdy\n\nCyberthreat talks\n\n09 Nov 2023, 5:00pm 60 min\n\n### Overview of modern car compromise techniques and methods of protection\n\n  * Alexander Kozlov\n  * Sergey Anufrienko\n\n##### Reports\n\n### ToddyCat is making holes in your infrastructure\n\nWe continue to report on the APT group ToddyCat. This time, we\u2019ll talk about\ntraffic tunneling, constant access to a target infrastructure and data\nextraction from hosts.\n\n### DuneQuixote campaign targets Middle Eastern entities with \u201cCR4T\u201d malware\n\nNew unattributed DuneQuixote campaign targeting entities in the Middle East\nemploys droppers disguised as Total Commander installer and CR4T backdoor in C\nand Go.\n\n### HrServ \u2013 Previously unknown web shell used in APT attack\n\nIn this report Kaspersky researchers provide an analysis of the previously\nunknown HrServ web shell, which exhibits both APT and crimeware features and\nhas likely been active since 2021.\n\n### Modern Asian APT groups\u2019 tactics, techniques and procedures (TTPs)\n\nAsian APT groups target various organizations from a multitude of regions and\nindustries. We created this report to provide the cybersecurity community with\nthe best-prepared intelligence data to effectively counteract Asian APT\ngroups.\n\n##### Subscribe to our weekly e-mails\n\nThe hottest research right in your inbox\n\nThreats\n\nThreats\n\n  * APT (Targeted attacks)\n  * Secure environment (IoT)\n  * Mobile threats\n  * Financial threats\n  * Spam and phishing\n  * Industrial threats\n  * Web threats\n  * Vulnerabilities and exploits\n\nCategories\n\nCategories\n\n  * APT reports\n  * Malware descriptions\n  * Security Bulletin\n  * Malware reports\n  * Spam and phishing reports\n  * Security technologies\n  * Research\n  * Publications\n\nOther sections\n\n  * Archive\n  * All tags\n  * Webinars\n  * APT Logbook\n  * Statistics\n  * Encyclopedia\n  * Threats descriptions\n  * KSB 2023\n\n\u00a9 2024 AO Kaspersky Lab. All Rights Reserved. Registered trademarks and\nservice marks are the property of their respective owners.\n\n  * Privacy Policy\n  * License Agreement\n  * Cookies\n\n##### Subscribe to our weekly e-mails\n\nThe hottest research right in your inbox\n\nNotifications\n\n", "frontpage": false}
