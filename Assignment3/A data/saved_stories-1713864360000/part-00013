{"aid": "40127812", "title": "The rule of 4: anomalous distributions in stoichiometries of inorganic compounds", "url": "https://www.nature.com/articles/s41524-024-01248-z", "domain": "nature.com", "votes": 2, "user": "gnabgib", "posted_at": "2024-04-23 02:22:40", "comments": 0, "source_title": "The rule of four: anomalous distributions in the stoichiometries of inorganic compounds", "source_text": "The rule of four: anomalous distributions in the stoichiometries of inorganic compounds | npj Computational Materials\n\nLoading [MathJax]/jax/output/HTML-CSS/config.js\n\nSkip to main content\n\nThank you for visiting nature.com. You are using a browser version with\nlimited support for CSS. To obtain the best experience, we recommend you use a\nmore up to date browser (or turn off compatibility mode in Internet Explorer).\nIn the meantime, to ensure continued support, we are displaying the site\nwithout styles and JavaScript.\n\nAdvertisement\n\n  * View all journals\n  * Search\n\n## Search\n\nAdvanced search\n\n### Quick links\n\n    * Explore articles by subject\n    * Find a job\n    * Guide to authors\n    * Editorial policies\n\n  * Log in\n\n  * Explore content\n  * About the journal\n  * Publish with us\n\n  * Sign up for alerts\n  * RSS feed\n\nThe rule of four: anomalous distributions in the stoichiometries of inorganic\ncompounds\n\nDownload PDF\n\nDownload PDF\n\n  * Article\n  * Open access\n  * Published: 12 April 2024\n\n# The rule of four: anomalous distributions in the stoichiometries of\ninorganic compounds\n\n  * Elena Gazzarrini ORCID: orcid.org/0000-0001-5772-5166^1,\n  * Rose K. Cersonsky ORCID: orcid.org/0000-0003-4515-3441^2,\n  * Marnik Bercx^1,\n  * Carl S. Adorf ORCID: orcid.org/0000-0003-4962-2495^1 &\n  * ...\n  * Nicola Marzari ORCID: orcid.org/0000-0002-9764-0199^1\n\nnpj Computational Materials volume 10, Article number: 73 (2024) Cite this\narticle\n\n  * 1121 Accesses\n\n  * 33 Altmetric\n\n  * Metrics details\n\n## Abstract\n\nWhy are materials with specific characteristics more abundant than others?\nThis is a fundamental question in materials science and one that is\ntraditionally difficult to tackle, given the vastness of compositional and\nconfigurational space. We highlight here the anomalous abundance of inorganic\ncompounds whose primitive unit cell contains a number of atoms that is a\nmultiple of four. This occurrence\u2014named here the rule of four\u2014has to our\nknowledge not previously been reported or studied. Here, we first highlight\nthe rule\u2019s existence, especially notable when restricting oneself to\nexperimentally known compounds, and explore its possible relationship with\nestablished descriptors of crystal structures, from symmetries to energies. We\nthen investigate this relative abundance by looking at structural descriptors,\nboth of global (packing configurations) and local (the smooth overlap of\natomic positions) nature. Contrary to intuition, the overabundance does not\ncorrelate with low-energy or high-symmetry structures; in fact, structures\nwhich obey the rule of four are characterized by low symmetries and loosely\npacked arrangements maximizing the free volume. We are able to correlate this\nabundance with local structural symmetries, and visualize the results using a\nhybrid supervised-unsupervised machine learning method.\n\n### Similar content being viewed by others\n\n### Multivariate analysis of disorder in metal\u2013organic frameworks\n\nArticle Open access 21 April 2022\n\nAdam F. Sapnik, Irene Bechis, ... Thomas D. Bennett\n\n### Predicting stable crystalline compounds using chemical similarity\n\nArticle Open access 26 January 2021\n\nHai-Chen Wang, Silvana Botti & Miguel A. L. Marques\n\n### High-throughput prediction of the ground-state collinear magnetic order of\ninorganic materials using Density Functional Theory\n\nArticle Open access 06 June 2019\n\nMatthew Kristofer Horton, Joseph Harold Montoya, ... Kristin Aslaug Persson\n\n## Introduction\n\nComputational materials discovery is a fast-growing discipline leading to\ninnovation in many fields. Within a specific technological sector (i.e.,\ncommunications, renewable energies, medical), the choice of material is\ncritical for the long-lasting success of the given product. Therefore, it is\nimportant\u2014and of fundamental interest\u2014to efficiently identify materials\u2019\nstructural and energetic characteristics through materials\u2019 data analysis to\nselect structures for innovative applications. The emerging field of materials\ninformatics has demonstrated its potential as a springboard for materials\ndevelopment, alongside first-principles techniques such as density-functional\ntheory (DFT)^1,2. The increase in computational power, together with large-\nscale experimental^3 and computational high-throughput studies^4, is paving\nthe way for data-intensive, systematic approaches to classify materials\u2019\nfeatures and to screen for optimal experimental candidates. In addition, the\ncollection of statistical methods offered by machine learning (ML) has\naccelerated these efforts, both within fundamental and applied\nresearch^5,6,7,8,9,10.\n\nHowever, the success of these endeavours is ultimately limited by the quality\nand diversity of the data serving as the underlying data source. Understanding\nthe space of materials spanned by a dataset is integral to data-driven\nmaterials searches or machine-learning workflows. Thus, when anomalous\ncorrelations arise in datasets, it is useful to understand and investigate the\norigins, and potential implications, of such peculiarities. We use here the\nname rule of four (RoF) to describe the unusually high relative abundance of\nstructures with primitive unit cells containing a multiple of 4 atoms. This\noccurrence is explored within two different databases of inorganic crystal\nstructures: the Materials Project (MP)^11 database, which contains crystal\nstructures that have been relaxed with first-principles calculations starting\nfrom experimental databases or from structure-prediction methods, and the\nMaterials Cloud 3-dimensional crystal structures \u2018source\u2019 database\n(MC3D-source); this latter combines experimental structures from the\ncrystallographic open database (COD)^12,13,14,15, the inorganic crystal\nstructures database (ICSD)^16 and the materials platform for data science\n(MPDS). Note that for the ICSD and COD, occasionally some theoretically\npredicted structures can also be present, see section I in the supplementary\ninformation for more details. Figure 1 is a visual representation of this\nstriking abundance, while Table 1 demonstrates the RoF by comparing the\nrelative abundance of structures with primitive unit cells made up of multiple\nof 3, 4, 5, 6 and 7 atoms.\n\nFig. 1: The rule of four.\n\nThe two datasets (the Materials Project (MP)^11 and the Materials Cloud\n3-dimensional crystal structures \u2018source\u2019 database (MC3D-source)) contain a\ndisproportionate amount (coloured in red) of compounds with a primitive unit\ncell containing multiples of 4 atoms. n_RoF characterises the number of\nstructures in the datasets that obey the rule of four, while n_non\u2212RoF the\nones that do not. The distributions are normalised.\n\nFull size image\n\nTable 1 Percentages of structures in the MP and MC3D-source databases whose\nprimitive unit cells contain a number of atoms that is a multiple of the\ncolumn header\n\nFull size table\n\nWithin the context of this study, we will label a structure that belongs to\nthe subset of structures with a unit cell size multiple of four as a RoF\nstructure, and one that does not belong to the subset as a non-RoF structure.\nIn Fig. 1 the x axis is capped at 100 atoms to best represent the RoF, as\nrespectively 97.51% and 91.00% of structures in the MP and in the MC3D-source\ndatabases contain 100 atoms or less (the largest cell in the MP database\ncontains 296 atoms, while the MC3D-source one contains 4986 atoms).\n\nBefore delving into an extensive analysis, we rule out that the RoF is simply\nan artefact of how structures are mathemat- ically described, or of how this\ndescription is curated and processed for storage in the aforementioned\ndatabases (III A). We then decide to probe the RoF more deeply and attempt to\nunderstand its origins and impact. First, we examine the RoF with respect to\ntraditional materials science metrics, including energies and symmetries, and\nuncover that the RoF is largely correlated with loosely-packed polyatomic\nsystems (III B, III C). We then use symmetry-adapted machine learning\ntechniques to relate the RoF to local atomic environments and determine that\nit has only little implications for formation energy (III D). We finally\nmanage to correctly classify the RoF by only providing the algorithm with\ninformation on local\n\nstructural symmetry rather than a global one (III D). Although we explored\nmany meaningful avenues to rationalize the rule\u2019s existence and emergence, a\nfull explanation of the anomalous distribution is still missing. Since the\nmost plausibile causes have been explored, the present work serves also as a\nreference for future research on the topic.\n\n## Results\n\nWithin this study, we make sure that the data is sufficiently diverse for the\ntraining set to cover the whole design space^17 by procuring the structural\ndata from open and FAIR repositories^18,19,20; the same analytical workflow is\napplied to two different databases of bulk, crystalline, stoichiometric\ncompounds. One database is the Materials Project, which contained 83 989 data\nentries obtained via high-throughput DFT calculations as of 10/18/2018,\ncorresponding to the mp all 20181018 dataset retrieved with the\nmatminer.datasets module^21. The other data source, the MC3D-source, contains\n79 854 unique structures extracted from the MPDS, ICSD and COD, which have\nbeen curated via an AiiDA^22 workflow, as explained in Section I of the SI.\n\n### Primitive unit cell\n\nWhen materials structure datasets are prepared, it is standard procedure to\n\u2018primitivise\u2019 unit cells, i.e., to reduce the unit cell to its minimum volume.\nAs many conventional unit cells contain exactly four times the number of atoms\nthat would be found in their respective primitive unit cell, it could be\nexpected that misclassifying conventional unit cells as primitive ones could\nlead to an artificial emergence of the RoF. Both the MP and MC3D-source\ndatabases obtain the primitive unit cell using the spglib software^23. When\nprimitivizing the structure, one needs to set the symprec tolerance parameter,\nwhich allows for slight deviations in the atomic positions stemming from\nthermal motion or experimental noise. To rule out that the primitivization is\nthe source of the emergence of the RoF, we show in Fig. 2 that changing the\nsymprec (1E-8 to 1E-1\u00c5) parameter has little effect on the RoF distribution,\nconverting around 1% of RoF structures into non-RoF ones. It is only when one\nincreases the symprec to unreasonably large values (close to 1 \u00c5) that the\nslope changes\u2014this is expected, as using such a large tolerance effectively\nconsiders sites with the same element that should be different as identical,\nproducing primitive unit cells with a reduced number of sites, but which no\nlonger correctly describe the structure. Encouraged by these results, we\nproceed with a more extensive analysis.\n\nFig. 2: Percentage of RoF structures that become labelled non-RoF as a\nfunction of the symmetry tolerance parameter used for reduction to the\nprimitive cell.\n\nThe black and green lines correspond to structures in the MP and MC3D-source\ndatasets, respectively. At typical symmetrization parameters, there is little\nto no change in the number of RoF structures (roughly 1% of RoF structures go\nto non-RoF). At larger symmetrization parameters (\u22481 \u00c5), this increases to\nroughly 6% based upon the large deviations allowed in considering sites as\nsymmetrically equivalent.\n\nFull size image\n\n### Formation energy\n\nWe first test whether the RoF is correlated with stability with respect to\nelemental phases, as this would provide a straightforward explanation for the\nphenomenon. To test this assumption, we analyze the information contained in\nthe MP dataset, namely the formation energy per atom within each compound.\nThis is the energy of the compound with respect to standard states (elements),\nnormalized per atom. For example, for Fe2O3 the formation energy is\n[E(Fe_2O_3)\u20132E(Fe)\u2013(3/2)E(O_2)]/5. It is computed at a temperature of 0 K and\na pressure of 0 atm. This quantity is often a good approximation for formation\nenthalpy at ambient conditions, where a negative formation energy implies\nstability with respect to elemental compounds.\n\nOur initial results provide no evidence of a correlation between RoF compounds\nand their formation energy, as shown in Fig. 3. Nevertheless, it does appear\nthat structures obeying the RoF have a longer positive tail of large formation\nenergies, seen towards the bottom right of the figure.\n\nFig. 3: Distribution of formation energies.\n\nNormalised distribution of formation energies for the 83 989 compounds from\nthe Materials Project, normalized for each subgroup. RoF compounds are\ncoloured in red and non-RoF are coloured in blue.\n\nFull size image\n\nHowever, this result can be misleading\u2014it does not take into consideration the\nlarge variance in structural composition across the database\u2014and we must aim\nto compare the energies of similar structures within the RoF and non-RoF\nsubsets, as we will do in later sections.\n\n### Correlation with symmetry descriptors\n\nThe crystal symmetries of compounds\u2014defined by the set of symmetry operations\nthat, when performed, leave the structure unchanged\u2014are captured in crystals\nby their space groups and point groups. Higher symmetry space groups inherit\nthe symmetry operations of their \u2018parent\u2019 point groups; for example, cubic\nspace groups inherit the one-fold, two-fold, and four-fold rotational\nsymmetries (for the interested reader, the concept of inherited symmetry is\nenumerated nicely in Fig. 1.5 of the book chapter by Hestenes^24). Figure 4\nshows histograms of inherited symmetries and their relative abundance within\neach of the two sets (RoF in red and non-RoF in blue). The point groups are\nordered from the ones with the least number of symmetry operations (bottom) to\nthe highest order ones (top). Symmetry groups that are equally represented in\nboth sets (i.e. 1-rotation, since all compounds are invariant to the simplest\nsymmetry) have tails of equal length, whereas symmetries seen in a larger\npercentage of RoF structures have a red tail to the right of the histogram.\n\nFig. 4: Point groups analysis.\n\nProportion of structures in both databases (a) MC3D-source and (b) MP that\nbelong to each point group represented on the y axis, counted based on their\ninherited symmetries. RoF compounds are coloured in red, while non-RoF ones in\nblue.\n\nFull size image\n\nFrom Fig. 4, the relative abundance of non-RoF structures in the high symmetry\npoint groups emerges, while on the contrary most RoF structures in both\ndatabases are grouped in the lowest symmetry point groups (2, m, 2/m, mm2, 222\nand mmm), which generally contain a relative abundance of them apart from one\nexception (the MC3D-source presents. a slightly higher relative abundance of\nnon-RoF structures in the mm2 point group). This analysis shows how 4-fold\nsymmetry is not a determining descriptor to classify the phenomenon.\n\nThe the lack of higher symmetry groups in RoF compounds could be correlated by\na heterogeneous composition of atoms; this heterogeneity can be quantified by\ncounting the number of atomic species (N_species) (first column of Fig. 5, in\nlogarithmic scale) composing the structures: from this analysis we see that\nRoF materials are mostly composed of 4 or more elements (statistics start\nbeing less reliable after N_species = 8), while non-RoF structures present a\nlarger abundance of simpler composition, containing more often 1, 2, or 3\nelements. When looking at chemical composition, the hypothesis of the RoF\nemerging from signatures associated to a specific element have been ruled out.\nFor example, when selecting from both datasets only structures containing Si\n(the first direct candidate having a typical coordination number of 4), the\nRoF still emerges with a probability of 59.07% for the MP dataset and 57.32%\nfor the MC3D-source one. These statistics are not sufficiently divergent from\nthe results in Table 1.\n\nFig. 5: Distribution of geometric properties.\n\nDifferent geometric properties of each compound are analysed for the (a)\nMC3D-source and (b) MP databases. From left to right, the plots represent the\nnormalised distribution of the number of elemental species (N_species), the\nrelative abundance of small (N_S) to large (N_L) atomic radii (x), the ratio\nbetween smallest (R_S) and largest (R_L) atomic radii (\u03b1) and the packing\nfraction (PF) for compounds with a unit cell size between 0 and 100 atoms. All\nof the results are plotted for the two sets, RoF (red) and non-RoF (blue),\nwith the probability normalized to each set.\n\nFull size image\n\nAnother property that emerges from our analysis and is more evident in the MP\ndataset (second column of Fig. 5(b)) is the relative abundance of smaller\natomic radii within RoF compounds, as often defined by the parameter\n\\\\(x=\\frac{{N}_{s}}{{N}_{s}+{N}_{L}}\\\\)^25, where N_S and N_L are the counts,\nin a given structure, of the smallest and largest radii respectively. When\nconsidering this parameter, we focus our attention on the MC3D-source dataset,\nwhich contains bigger and more complex structures, where the divergence\nbetween the smallest and largest atoms is more considerable. In fact, the\nfirst peak in Fig. 1 for the MP is very large, hinting at the implicit bias of\ncomputational studies, where larger structures are often avoided based upon\ncomputational cost of calculations. The abundance of small atomic radii in RoF\ncompounds of the MC3D-source dataset (higher x parameter) partly explains the\nlower symmetries that characterise them, as more atoms will be inserted as\n\u2018interstitial\u2019 elements in a given structure, characterising the\n\u2018imperfections\u2019 that eventually contribute in lowering the overall structural\nsymmetry of point groups analyzed in Fig. 4.\n\nIn general, the symmetry type of atomic crystal systems is strictly linked to\npacking mechanisms^26,27,28. While the mathematical problem of sphere packing\nis not hard to pose (Kepler conjecture), it was historically difficult to\nprove^29, and the complexity of its solution rises exponentially with\npolydispersity^30.\n\nDespite this, a qualitative analysis of RoF configurations shows that they\ncontain chemical elements whose size variance is greater compared to the\nvariance in the non-RoF population.\n\nThis size variance is quantified by the parameter \\\\(\\alpha\n=\\frac{{R}_{S}}{{R}_{L}}\\\\) (where R_L is the radius of the largest atomic\nradius and R_S of the smallest one), namely the ratio between the smallest and\nthe biggest atomic radii within each compound (third column of Fig. 5). For\nthe same reason as above, in the context of this parameter the results of the\nMC3D-source dataset are considered more relevant. RoF compounds from the\nMC3D-source exhibit a greater standard deviation between largest and smallest\natoms, with the \u03b1 parameter presenting a peak at around 0.35; this finding\nsuggests the presence of very small radii filling the interstitial spaces,\nwhich contribute to keeping the symmetry of RoF compounds low, as was\npreviously highlighted by the analysis of the x paramter.\n\nHowever, there is no overarching evidence in the distributions of the x and \u03b1\nparameters that allows us to confirm a correlation between the emergence of\nthe RoF and the abundance of \u2018intestitial\u2019 elements.\n\nThe packing fraction (PF), defined as as\n\\\\({PF}=\\frac{{V}_{{tot},{atoms}}}{{V}_{{cell}}}\\\\) (where V _tot,atoms is the\ntotal volume of all atoms composing the structure, and V _cell is the unit\ncell\u2019s volume) is another related property of sphere packing^26,27. This\nquantity is noticeably lower (with peaks at values around 0.1\u20130.2) for RoF\nstructures, as can be seen in the last column of Fig. 5a, b, pointing away\nfrom packing arguments as the cause of this database anomaly. The sharp red\npeaks in PF might characterise disordered compounds such as porous materials,\nwhich have been determined to be outliers for the MC3D-source dataset.\n\n### Employing symmetry-adapted descriptors for further insight\n\nUp until this point we have employed classical techniques for analyzing\ncrystal structures; these have offered little to no insights on the origins of\nthe RoF anomalous distribution, but have allowed us to exclude packing\narguments and symmetrical global descriptors as features that make the RoF\nemerge. Here, we therefore turn to more modern data- driven techniques. In the\nfield of atomistic modelling, it has been common, albeit non-trivial, to\nrepresent crystal structures through symmetrized density correlations^9,31,32\nin order to predict broad swaths of materials properties. Here, we represent\nthe compounds using the Smooth Overlap of Atomic Positions (SOAP)^31, a\npopular ML representation for structure-energy relations that contains\ninformation on the average three-body local environment for atomic\narrangements. SOAP vectors provide an avenue for a statistical analysis on\nlocal environments, offering a robust framework through which we can explore\nand visualize the chemical and configuration space of the materials\nstudied^33. We use two parameterizations of SOAP vectors, detailed in Section\nII of the Supplementary Information: one that uses separate channels to\nrepresent different chemical species and another that ignores the chemical\nidentities in order to highlight the geometry of the local symmetry. The\nformer, from hereon called the species-tagged representation, is necessary in\nenergetic analysis, as similar geometry symmetries can correspond to wildly\ndifferent energetics given the elements present; however, this representation\nis computationally cumbersome (roughly 100 000 sparse features for each\ncompound, from which we take a diverse subset of 2 000 features). Thus, in\nlater analyses where the chemical identities play a smaller role, it is\nbeneficial and conceptually more straightforward to use the more lightweight,\nlatter representation (roughly 80 features for each compound), hereon called\nthe species-invariant representation.\n\nEarlier, we noted that simply presenting a histogram of RoF and non-RoF\nenergetics did not provide any specific understanding of the RoF; it might be\nmore insightful to compare the energies of chemically similar structures. To\ndetermine whether the RoF structures exhibit lower energy than structurally-\nsimilar non-RoF ones, we use Principal Covariates Regression (PCovR)^34,35, a\nML method which constructs a latent space projection to explore the\ncorrelation between stability and local symmetries within the dataset by\nexpanding regression models to incorporate information on the structure of the\ninput data, as implemented in the scikit-matter library^36,37. In this mixing\nmodel, the projection is weighted towards the property of interest using a\nmixing parameter (of which a more extensive explanation is given in\nSupplementary Fig. 1), and, where the input linearly correlates with the\ntarget property, the resulting embedding will reflect this property along the\nfirst component, with subsequent components representing orthogonal dimensions\nin structure space. In our case the PCovR is always trained on the species-\ntagged SOAP vectors and their formation energies. We plot the first two\nprincipal covariates in Fig. 6. The first principal covariate is strongly\ncorrelated to the energetic descriptor, as can be seen in Fig. 6, where in the\nlower plots we have coloured each point in the projection by their RoF\nclassification (left) and formation energy (right). However, the second\ncovariate (and all significant subsequent covariates, see Supplementary Figs.\n2-4) fail to separate the datasets into two distinct populations corresponding\nto this phenomenom. This implies that for structurally similar compounds,\nthere is no significant difference in energy between RoF and non-RoF samples.\nWe also see little difference in the spread of RoF versus non-RoF structures\nin the latent space, as shown by the kernel density probability map in the\nupper panel of Fig. 6. Further principal covariates for the same PCovR\nrepresentation are plotted in Supplementary Figs. 2-4, as well as other\nrelevant energetic descriptors (the energy above the convex hull energy, i.e.,\nthe envelope connecting the lowest energy compounds in the chemical space, and\nthe band gap energy), in order to show how these targets yield similar\nresults. Thus the RoF is neither correlated with the energetics, nor are RoF\nlower in formation energy when compared to chemically similar non-RoF ones.\n\nFig. 6: PCovR representation of the MP dataset with a mixing parameter of \u03b2 =\n0.5.\n\nThe model is regressed on the formation energy per atom. The three plots\ncontain the same data, represented on the top through a kernel density\nprobability distribution (the RoF subset is coloured in red and the non-RoF\none in blue), coloured according to the subset classification (lower left) and\naccording to the formation energy per atom (lower right). The plot on the top\nis generated with the seaborn.kdeplot() function.\n\nFull size image\n\nThe linear correlation between the average local symmetries and the RoF is not\nparticularly strong (a logistic regression on the SOAP vectors results in an\naccuracy on the order of 0.6, as listed in Table 1 of the SI); thus, we turn\nto non-linear classifications to understand if the RoF is potentially\ncorrelated with these local neighbourhoods. We ignore the species information\nto focus solely on the average local symmetries. We build a Random Forest (RF)\nclassification^38 on both datasets, first varying the interaction cutoff that\ndefines the local environment (see Fig. 7). We see a plateau in accuracy on\nthe test set at 87% as we consider local environments of 4.0 \u00c5, suggesting\nthat differentiating local symmetries occur within the first two neighbour\nshells, also supported by the high false positive (FP) rate at small cutoff\nradii. From the learning curve on the 4.0 \u00c5 escriptors (inset), we see that\nthe classification has a positive learning rate, although shows little\nsaturation despite the large training set. This result implies that local\nfeatures are sufficient for the ML model to pick up the complexity of the\ndatasets and to predict with good probability the correct classification. We\nreport the accuracy on the test set achieved by other classification\nalgorithms in Section V of the SI. To visualise the stoichiometry of materials\nfalling into one of the two categories, the interested reader is referred to\nour Materials Cloud Archive^39 entry, from which a json.gz file for each\ndatabase can be downloaded. This can be uploaded on the Chemiscope^40 web\ninterface to visualise a 2D plot of the first principal covariates. The\nchemical composition of each dataset structure can be inspected by clicking on\nthe dots composing the scatter plot. The colouring can be done according to\ndifferent parameters, of which the most insightful one is the classification\noutcome.\n\nFig. 7: Random forest classification on local symmetries.\n\nHere we use the species-invariant 3-body SOAP vectors to build a random forest\nensemble classifier. Test set accuracy, represented on the y axis, saturates\nat ~4.0 A, with little additional gain at larger cutoff radii. Below the\nfigure we show the table of true positive (TP), true negative (TN), false\npositive (FP), and false negative (FN) results, showing that the classifier is\nunable to differentiate RoF and non-RoF structures at lower cutoff radii,\nleading to a high false positive (FP) rate. Inset in the upper figure is a\nlearning curve for a cutoff radius of 4.0 \u00c5, which shows a positive learning\nrate, albeit no saturation, an indication that secondary effects beyond the\nlocal environments play a role (or, more unlikely, that the dataset is not\nsufficiently large).\n\nFull size image\n\n## Discussion\n\nThrough an extensive investigation, in this work we highlight and analyze the\nanomalous abundance of inorganic compounds whose primitive unit cell contains\na number of atoms that is a multiple of four, a property that we name rule of\nfour (RoF) and that is observed in both experimental and DFT-generated\nstructure databases. Here, we:\n\n  * highlight the rule\u2019s existence, especially notable when restricting oneself to mostly experimentally known compounds;\n\n  * explore its possible relationship with established energetic descriptors, namely formation energies, and utilise hybrid ML methods combining regression and principal component analysis to surprisingly rule out the possibility that the relative abundance has the (expected) effect of stabilising compounds, bringing them to a lower energy state;\n\n  * conclude, through a global structural composition analysis of point groups and packing fractions, that the overabun- dance does not either correlate with high-symmetry structures, but rather to low symmetries and loosely packed arrangements maximising the free volume;\n\n  * predict, with an accuracy of 87% the association to the rule of four of a compound by providing a random forest classification algorithm with local structural descriptors (the smooth overlap of atomic positions) only, eventually highlighting the importance of local symmetry rather than global one for the emergence of the rule of four.\n\nThis analysis constitutes a valuable reference for further systematic studies\ntargeting the classification of materials\u2019 features with specific ML\napproaches in order to screen for optimal experimental candidates. Moreover,\nthe study provides a starting point for future investigations on the rule\u2019s\nemergence, given that a fully satisfactory explanation of such anomalous\ndistribution is as yet lacking.\n\n## Methods\n\n### Reduction to the primitive cell\n\nAll the structures in both databases are reduced to the primitive cell using\nthe find primitive function of the spglib^23 package, varying the symprec\nvalue in the range of 1E \u2212 8 to 1 \u00c5.\n\n### Scalar global descriptors\n\nThe symmetry of compounds is investigated by looking at space groups and point\ngroups. subgroup of symmetry operations over which the space group is\ninvariant. With a total number of 32 point groups, it is easier to convey the\nsymmetric properties of the vast variety of compounds via their point group\nrather than their space groups; while space groups uniquely identify geometric\nproperties, point groups identify symmetry classes and reduce the parameter\nspace to a lower degree when investigating the symmetries of all compounds.\nThe point groups are calculated through the spglib^23 and seekpath^41 packages\nfor the MC3D-source database, while we used the SymmetryAnalyzer pymatgen\nmodule\u2014which also relies on the spglib package developed by Togo and\nTanaka^23\u2014to find the symmetry operators and point groups for the MP dataset,\nat a symprec of 0.3 \u00c5. As concerns packing mechanisms, we extend the\nconventions employed by Hopkins^25 to n-elements packing and employ the \u03b1, PF\nand x parameters. In structures with FCC and HCP symmetry, the maximum packing\nfraction is 0.74. \u03b1 = 1 denotes unary compound. Conversely, when \u03b1 0 the\ncompounds contain elements whose atomic radii distribution presents a wider\nspread.\n\n### Local symmetry descriptors and ML pipeline\n\nWe adopt the following ML pipeline to study local symmetries and energetic\neffects. First, the atomic representation of each compound is obtained with\nSOAP vectors (see section II of the Supplementary Information), computed with\nthe librascal library^33. The SOAP features are then averaged within each\ncompound, and the representations from the two datasets are normalised\nsimultaneously. We then select a diverse subset of 2 000 features through\nFurthest Point Sampling (FPS) algorithm^36,37,42,43, efficiently reducing the\ndataset size without losing important information. For Sec.III D, we perform a\nlinear ridge regression with 4-fold cross-validation\u2014which optimises the\nregularisation parameter to prevent overfitting\u2014on the formation energies data\nretrieved from the MP database to ascertain the accuracy of the model. Table 2\nillustrates the RMSE and the uncertainty in units of eV of the predicted\nenergetic quantities.\n\nTable 2 RMSE and uncertainty in units on the predicted energetic quantities\nfor the MP database\n\nFull size table\n\nCompared to results in the literature, which achieve an accuracy in formation\nenergy prediction of 0.173 eV (Automatminer^44) and 0.0332 eV (Crystal Graph\nConvolutional Neural Networks^45), the accuracy of 0.4002 eV is sufficient for\nthis study, since the aim of our study is not to find the most efficient way\nto predict energies, but rather to provide a sufficient regression prediction\nto employ in PCovR analysis. We use the species-invariant SOAP vectors to\nclassify the RoF phe- nomenon using scikit-learn\u2019s^46 RandomForestClassifier\nalgorithm^47, which accepts binary labels as target properties (RoF or non-\nRoF) and outputs a probability between 0 and 1 for each compound to fall into\nthe RoF subset. Training and testing set constitute respectively 90 and 10% of\nthe whole dataset. Our random forest classification comprises 100 random\ndecision trees. This classifier performs better in our case compared to\nSupport Vector Machine (SVM) and Logistic Regression (LR) classifiers,\nsignifying a need for a stochastic model.\n\n## Data availability\n\nThe full dataset employed for the analysis can be downloaded from the\nMaterials Cloud Archive^39, where the MC3D- source data is only provided in\nSOAP format as the experimental structures can not be released due to\nlicensing constraints. Its DFT\u2013relaxed counterpart is available at:\nhttps://archive.materialscloud.org/record/2022.38. Instead, we provide the\nfull list of structure IDs for each database, including the version of the\ndatabase upon the time of extraction.\n\n## Code availability\n\nThe codes to reproduce the results and figures can be found at:\nhttps://github.com/epfl-theos/r4-project. As the MC3D- source structure data\ncannot be made publicly available due to licensing contraints, the repository\ncontains example data from a reduced random subset of the publicly available\nMP dataset in order to test run a preliminary analysis.\n\n## References\n\n  1. Hohenberg, P. & Kohn, W. Inhomogeneous electron gas. Phys. Rev. 136, B864\u2013B871 (1964).\n\nArticle Google Scholar\n\n  2. Marzari, N., Ferretti, A. & Wolverton, C. Electronic-structure methods for materials design. Nat. Mater. 20, 736\u2013749 (2021).\n\nArticle CAS PubMed Google Scholar\n\n  3. Suram, S. K., Haber, J. A., Jin, J. & Gregoire, J. M. Generating information-rich high-throughput experimental materials genomes using functional clustering via multitree genetic programming and information theory. ACS Comb. Sci. 17, 224\u2013233 (2015).\n\nArticle CAS PubMed Google Scholar\n\n  4. Curtarolo, S. et al. The high-throughput highway to computational materials design. Nat. Mater. 12, 191\u2013201 (2013).\n\nArticle CAS PubMed Google Scholar\n\n  5. Vasudevan, R. K. et al. Materials science in the artificial intelligence age: high-throughput library generation, machine learning, and a pathway from correlations to the underpinning physics. MRS Commun. 9, 821\u2013838 (2019).\n\nArticle CAS Google Scholar\n\n  6. Pilania, G., Wang, C., Jiang, X., Rajasekaran, S. & Ramprasad, R. Accelerating materials property predictions using machine learning. Sci. Rep. 3, 2810 (2013).\n\nArticle PubMed PubMed Central Google Scholar\n\n  7. Rupp, M., Tkatchenko, A., Mueller, K.-R. & von Lilienfeld, O. A. Fast and accurate modeling of molecular atomization energies with machine learning. Phys. Rev. Lett. 108, 058301 (2012).\n\n  8. Sanchez-Lengeling, B. & Aspuru-Guzik, A. Inverse molecular design using machine learning: generative models for matter engineering. Science 361, 360\u2013365 (2018).\n\nArticle CAS PubMed Google Scholar\n\n  9. Bart \u0301ok, A. P. et al. Machine learning unifies the modeling of materials and molecules. Sci. Adv. 3, e1701816 (2017).\n\nArticle PubMed Google Scholar\n\n  10. De, S., Bart \u0301ok, A. P., Cs \u0301anyi, G. & Ceriotti, M. Comparing molecules and solids across structural and alchemical space. Phys. Chem. Chem. Phys. 18, 13754\u201313769 (2016).\n\nArticle CAS PubMed Google Scholar\n\n  11. Jain, A. et al. Commentary: The materials project: a materials genome approach to accelerating materials innovation. APL Mater. 1, 011002 (2013).\n\nArticle Google Scholar\n\n  12. Vaitkus, A., Merkys, A. & Gra\u02c7zulis, S. Validation of the crystallography open database using the crystallographic information framework. J. Appl. Crystallogr. 54, 661\u2013672 (2021).\n\nArticle CAS PubMed PubMed Central Google Scholar\n\n  13. Quir \u0301os, M., Gra\u02c7zulis, S., Girdzijauskaite \u0307, S., Merkys, A. & Vaitkus, A. Using SMILES strings for the description of chemical connectivity in the crystallography open database. J. Cheminformatics 10, 23 (2018).\n\n  14. Merkys, A. et al. COD::CIF::Parser: an error-correcting CIF parser for the Perl language. J. Appl. Crystallogr. https://doi.org/10.1107/S1600576715022396 (2016).\n\n  15. Gra\u02c7zulis, S., Merkys, A., Vaitkus, A. & Okuli\u02c7c-Kazarinas, M. Computing stoichiometric molecular composition from crystal structures. J. Appl. Crystallogr. 48, 85\u201391 (2015).\n\nArticle PubMed Google Scholar\n\n  16. Levin, I. NIST Inorganic Crystal Structure Database (ICSD). National Institute of Standards and Technology Public Data Repository. https://data.nist.gov/od/id/mds2-2147 (2018)\n\n  17. Ajiboye, A., Abdullah-Arshah, R., Qin, H. & Isah-Kebbe, H. Evaluating the effect of dataset size on predictive model using supervised learning technique. IJSECS 1, 75\u201384 (2015).\n\nArticle Google Scholar\n\n  18. Wilkinson, M. et al. The fair guiding principles for scientific data management and stewardship. Sci. Data 3, 160018 (2016).\n\n  19. Schmidt, J., Marques, M. R. G., Botti, S. & Marques, M. A. L. Recent advances and applications of machine learning in solid-state materials science. npj Comput. Mater. 5, 1\u201336 (2019).\n\nArticle Google Scholar\n\n  20. Draxl, C. & Scheffler, M. NOMAD: The FAIR concept for big data-driven materials science. MRS Bull. 43, 676\u2013682 (2018).\n\nArticle Google Scholar\n\n  21. Pizzi, G., Togo, A. & Kozinsky, B. Matminer, access ready made datasets in one line. https://hackingmaterials.lbl.gov/matminer/#access-ready-made-datasets-in-one-line (2023).\n\n  22. Pizzi, G., Togo, A. & Kozinsky, B. Provenance, workflows, and crystallographic tools in materials science: AiiDa, spglib, and seekpath. MRS Bull. 43, 696\u2013702 (2018).\n\nArticle Google Scholar\n\n  23. Togo, A. & Tanaka, I. Spglib: a software library for crystal symmetry search. arXiv https://arxiv.org/abs/1808.01590 (2018).\n\n  24. Hestenes, D. in Applications of Geometric Algebra in Computer Science and Engineering (eds. Dorst, L., Doran, C. & Lasenby, J.) 3\u201334 (Birkh \u0308auser Boston, Boston, MA, 2002).\n\n  25. Hopkins, A. B., Jiao, Y., Stillinger, F. H. & Torquato, S. Phase diagram and structural diversity of the densest binary sphere packings. Phys. Rev. Lett. 107, 125501 (2011).\n\n  26. De Graaf, J., Van Roij, R. & Dijkstra, M. Dense regular packings of irregular nonconvex particles. Phys. Rev. Lett. 107, 155501 (2011).\n\nArticle PubMed Google Scholar\n\n  27. Torquato, S. & Jiao, Y. Dense packings of the platonic and archimedean solids. Nature 460, 876\u2013879 (2009).\n\nArticle CAS PubMed Google Scholar\n\n  28. Cersonsky, R. K., van Anders, G., Dodd, P. M. & Glotzer, S. C. Relevance of packing to colloidal self-assembly. Proc. Natl. Acad. Sci. USA 115, 1439\u20131444 (2018).\n\n  29. Hales, T. A proof of the kepler conjecture. Ann. Math. 162, 1065\u20131185 (2005).\n\nArticle Google Scholar\n\n  30. Torquato, S. Perspective: Basic understanding of condensed phases of matter via packing models. J. Chem. Phys. 149, 020901 (2018).\n\nArticle CAS PubMed Google Scholar\n\n  31. Bart \u0301ok, A. P., Kondor, R. & Cs \u0301anyi, G. On representing chemical environments. Phys. Rev. B: Condens. Matter 87, 184115 (2013).\n\nArticle Google Scholar\n\n  32. Behler, J. & Parrinello, M. Generalized neural-network representation of high-dimensional potential-energy surfaces. Phys. Rev. Lett. 98, 146401 (2007).\n\nArticle PubMed Google Scholar\n\n  33. Musil, F. et al. Efficient implementation of atom-density representations. J. Chem. Phys. 154, 114109 (2021).\n\nArticle CAS PubMed Google Scholar\n\n  34. de Jong, S. & Kiers, H. A. Principal covariates regression: part i. theory. Chemom. Intell. Lab. Syst. 14, 155\u2013164 (1992).\n\nArticle Google Scholar\n\n  35. Helfrecht, B. A., Cersonsky, R. K., Fraux, G. & Ceriotti, M. Structure-property maps with Kernel principal covariates regression. Mach. Learn.: Sci. Technol. 1, 045021 (2020).\n\nGoogle Scholar\n\n  36. Cersonsky, R. K. et al. scikit-learn-contrib/scikit-matter: pre-release of v0.1. Zenodo https://doi.org/10.5281/zenodo.4727575. (2021)\n\n  37. Goscinski, A. et al. scikit-matter: A suite of generalisable machine learning methods born out of chemistry and materials science. Open Res. Europe 3, 81(2023).\n\n  38. Breiman, L. Random forests. Mach. Learn. 45, 5\u201332 (2001).\n\nArticle Google Scholar\n\n  39. Gazzarrini, E., Cersonsky, R. K., Bercx, M., Adorf, C. S. & Marzari, N. The Rule of Four: Anomalous Stoichiometries of Inorganic Compounds. https://archive.materialscloud.org/record/2023.104. (2023)\n\n  40. Fraux, G., Cersonsky, R. K. & Ceriotti, M. Chemiscope: interactive structure-property explorer for materials and molecules. J. Open Res. Softw. 5, 2117 (2020).\n\nArticle Google Scholar\n\n  41. Hinuma, Y., Pizzi, G., Kumagai, Y., Oba, F. & Tanaka, I. Band structure diagram paths based on crystallography. arXiv https://arxiv.org/abs/1602.06402 (2016).\n\n  42. Eldar, Y., Lindenbaum, M., Porat, M. & Zeevi, Y. Y. The farthest point strategy for progressive image sampling. IEEE Trans. Image Process. 6, 1305\u20131315 (1997).\n\nArticle CAS PubMed Google Scholar\n\n  43. Cersonsky, R. K., Helfrecht, B. A., Engel, E. A., Kliavinek, S. & Ceriotti, M. Improving sample and feature selection with principal covariates regression. Mach. Learn.: Sci. Technol. 2, 035038 (2021).\n\nGoogle Scholar\n\n  44. Dunn, A., Wang, Q., Ganose, A., Dopp, D. & Jain, A. Benchmarking materials property prediction methods: the matbench test set and automatminer reference algorithm. npj Comput. Mater. 6, 1\u201310 (2020).\n\nGoogle Scholar\n\n  45. Ziletti, A., Kumar, D., Scheffler, M. & Ghiringhelli, L. M. Insightful classification of crystal structures using deep learning. Nat. Commun. 9, 2775 (2018).\n\nArticle PubMed PubMed Central Google Scholar\n\n  46. Pedregosa, F. et al. Scikit-learn: machine learning in Python. J. Mach. Learn. Res. 12, 2825\u20132830 (2011).\n\nGoogle Scholar\n\n  47. Couronn \u0301e, R., Probst, P. & Boulesteix, A.-L. Random forest versus logistic regression: a large-scale benchmark experiment. BMC Bioinf. 19, 270 (2018).\n\nDownload references\n\n## Acknowledgements\n\nThis work was supported by a MARVEL INSPIRE Potentials Master\u2019s Fellowship and\nthe MARVEL National Centre of Competence in Research (NCCR) funded by the\nSwiss National Science Foundation (grant agreement ID 51NF40- 182892). RKC\nacknowledges funding from the European Research Council (ERC) under the\nEuropean Union\u2019s Horizon 2020 research and innovation programme under grant\nagreement No 677013-HBMAP. MB acknowledges funding by the European Union\u2019s\nHorizon 2020 research and innovation programme under grant agreement No.\n824143 (European MaX Centre of Excellence \u201cMaterials design at the Exascale\u201d).\nCSA acknowledges funding from the European Union\u2019s Horizon 2020 research and\ninnovation programme under grant agreement No 760173. The authors thank the\nAiiDA team for giving access to the full MC3D-source dataset, and are grateful\nto the technical and theoretical insights offered by the members of MARVEL,\nTHEOS, and COSMO.\n\n## Author information\n\n### Authors and Affiliations\n\n  1. Theory and Simulation of Materials (THEOS) and National Center for Computational Design and Discovery of Novel Materials (MARVEL), \u00c9cole Polytechnique F\u00e9d\u00e9rale de Lausanne, CH-1015, Lausanne, Switzerland\n\nElena Gazzarrini, Marnik Bercx, Carl S. Adorf & Nicola Marzari\n\n  2. Department of Chemical and Biological Engineering, University of Wisconsin - Madison, Madison, WI, USA\n\nRose K. Cersonsky\n\nAuthors\n\n  1. Elena Gazzarrini\n\nView author publications\n\nYou can also search for this author in PubMed Google Scholar\n\n  2. Rose K. Cersonsky\n\nView author publications\n\nYou can also search for this author in PubMed Google Scholar\n\n  3. Marnik Bercx\n\nView author publications\n\nYou can also search for this author in PubMed Google Scholar\n\n  4. Carl S. Adorf\n\nView author publications\n\nYou can also search for this author in PubMed Google Scholar\n\n  5. Nicola Marzari\n\nView author publications\n\nYou can also search for this author in PubMed Google Scholar\n\n### Contributions\n\nE.G. conducted the analysis on the data and wrote the paper in collaboration\nwith C.S.A and R.K.C. R.K.C. instructed on how to use many of the employed\ncomputational tools, designed the computational strategy, and helped conduct\nthe analysis and interpretation of the data. M.B. provided technical support,\nespecially on the MC3D-source dataset and helped with the analysis and\ninterpretation of the data. C.S.A. managed the project, wrote the paper, and\nhelped with the analysis and interpretation of the data. N.M. supervised the\nproject, helped with the interpretation of the results, and provided the\ninitial suggestion for the investigation. All authors edited and reviewed the\npaper.\n\n### Corresponding author\n\nCorrespondence to Elena Gazzarrini.\n\n## Ethics declarations\n\n### Competing interests\n\nThere are no competing interests to declare.\n\n## Additional information\n\nPublisher\u2019s note Springer Nature remains neutral with regard to jurisdictional\nclaims in published maps and institutional affiliations.\n\n## Supplementary information\n\n### The rule of four: anomalous distributions in the stoichiometries of\ninorganic compounds\u2014Supporting Information\n\n## Rights and permissions\n\nOpen Access This article is licensed under a Creative Commons Attribution 4.0\nInternational License, which permits use, sharing, adaptation, distribution\nand reproduction in any medium or format, as long as you give appropriate\ncredit to the original author(s) and the source, provide a link to the\nCreative Commons licence, and indicate if changes were made. The images or\nother third party material in this article are included in the article\u2019s\nCreative Commons licence, unless indicated otherwise in a credit line to the\nmaterial. If material is not included in the article\u2019s Creative Commons\nlicence and your intended use is not permitted by statutory regulation or\nexceeds the permitted use, you will need to obtain permission directly from\nthe copyright holder. To view a copy of this licence, visit\nhttp://creativecommons.org/licenses/by/4.0/.\n\nReprints and permissions\n\n## About this article\n\n### Cite this article\n\nGazzarrini, E., Cersonsky, R.K., Bercx, M. et al. The rule of four: anomalous\ndistributions in the stoichiometries of inorganic compounds. npj Comput Mater\n10, 73 (2024). https://doi.org/10.1038/s41524-024-01248-z\n\nDownload citation\n\n  * Received: 26 July 2023\n\n  * Accepted: 22 March 2024\n\n  * Published: 12 April 2024\n\n  * DOI: https://doi.org/10.1038/s41524-024-01248-z\n\n### Share this article\n\nAnyone you share the following link with will be able to read this content:\n\nSorry, a shareable link is not currently available for this article.\n\nProvided by the Springer Nature SharedIt content-sharing initiative\n\n### Subjects\n\n  * Condensed-matter physics\n  * Structure of solids and liquids\n\nDownload PDF\n\nAdvertisement\n\nnpj Computational Materials (npj Comput Mater) ISSN 2057-3960 (online)\n\n## nature.com sitemap\n\n### About Nature Portfolio\n\n  * About us\n  * Press releases\n  * Press office\n  * Contact us\n\n### Discover content\n\n  * Journals A-Z\n  * Articles by subject\n  * protocols.io\n  * Nature Index\n\n### Publishing policies\n\n  * Nature portfolio policies\n  * Open access\n\n### Author & Researcher services\n\n  * Reprints & permissions\n  * Research data\n  * Language editing\n  * Scientific editing\n  * Nature Masterclasses\n  * Research Solutions\n\n### Libraries & institutions\n\n  * Librarian service & tools\n  * Librarian portal\n  * Open research\n  * Recommend to library\n\n### Advertising & partnerships\n\n  * Advertising\n  * Partnerships & Services\n  * Media kits\n  * Branded content\n\n### Professional development\n\n  * Nature Careers\n  * Nature Conferences\n\n### Regional websites\n\n  * Nature Africa\n  * Nature China\n  * Nature India\n  * Nature Italy\n  * Nature Japan\n  * Nature Middle East\n\n  * Privacy Policy\n  * Use of cookies\n  * Legal notice\n  * Accessibility statement\n  * Terms & Conditions\n  * Your US state privacy rights\n  * Cancel contracts here\n\n\u00a9 2024 Springer Nature Limited\n\nSign up for the Nature Briefing newsletter \u2014 what matters in science, free to\nyour inbox daily.\n\nGet the most important science stories of the day, free in your inbox. Sign up\nfor Nature Briefing\n\n", "frontpage": false}
